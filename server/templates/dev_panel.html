<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>DEV Панель – ASFES</title>
    <link rel="stylesheet" href="{{ url_for('static', path='dev/dev.css') }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script type="application/json" id="vk-config-json">
        {
            "clientId": {{ vk_client_id | tojson }},
            "redirectUrl": {{ vk_redirect_url | tojson }}
        }
    </script>

    <script>
        window.VK_DEV_CONFIG = JSON.parse(
            document.getElementById("vk-config-json").textContent
        );
    </script>

    <script src="https://unpkg.com/@vkid/sdk/dist-sdk/umd/index.js"></script>
</head>
<body>
<div class="dev-root">
    <header class="dev-header">
        <div class="dev-title">
            <span class="dev-title-main">ASFES DEV Panel</span>
            <span class="dev-title-sub">Тестирование API /user и /dev</span>
        </div>
        <div class="dev-env-badge">
            DEV = {{ 'True' if dev else 'False' }}
        </div>
    </header>

    <main class="dev-main">
        <aside class="dev-sidebar">
            <div class="dev-section-title">Пользователи</div>
            <button class="dev-tab-btn" data-endpoint-id="auth">/user/auth (POST)</button>
            <button class="dev-tab-btn" data-endpoint-id="register">/user/register (POST)</button>
            <button class="dev-tab-btn" data-endpoint-id="create">/user/create (POST)</button>
            <button class="dev-tab-btn" data-endpoint-id="update">/user/update (PUT)</button>
            <button class="dev-tab-btn" data-endpoint-id="delete">/user/delete (DELETE)</button>
            <button class="dev-tab-btn" data-endpoint-id="logout">/user/logout (POST)</button>

            <div class="dev-section-title">VK ID</div>
            <button class="dev-tab-btn" data-endpoint-id="vk_callback">/user/auth/vk/callback (GET)</button>

            <div class="dev-section-title">DEV</div>
            <button class="dev-tab-btn" data-endpoint-id="test_mail">/dev/test_mail (POST)</button>
            <button class="dev-tab-btn" data-endpoint-id="test_weather">/dev/test_weather (POST)</button>

            <div class="dev-section-title">Сервис</div>
            <button class="dev-tab-btn" data-endpoint-id="healthz">/healthz (GET)</button>
        </aside>

        <section class="dev-content">
            <div class="dev-current-endpoint">
                <div class="dev-ep-method" id="ep-method">POST</div>
                <div class="dev-ep-path" id="ep-path">/user/auth</div>
            </div>

            <form id="dev-form" class="dev-form">
                <div id="dev-fields"></div>

                <div class="dev-form-actions">
                    <button type="submit" class="dev-send-btn">Отправить запрос</button>
                    <button type="button" id="dev-clear-btn" class="dev-clear-btn">Очистить</button>
                </div>
            </form>

            <section class="dev-response">
                <div class="dev-response-header">
                    <span>Ответ</span>
                    <span class="dev-response-meta" id="dev-response-meta"></span>
                </div>
                <pre id="dev-response-body" class="dev-response-body">// Ответ появится здесь</pre>
            </section>

            <section class="dev-vk-section">
                <div class="dev-response-header">
                    <span>Вход через VK ID</span>
                    <span class="dev-response-meta" id="vkid-status"></span>
                </div>
                <div id="vkid-one-tap"></div>
            </section>
        </section>
    </main>

    <footer class="dev-footer">
        <span>ASFES DEV Panel • {{ request.url.hostname or 'localhost' }}</span>
        <span class="dev-footer-hint">Куки access_token используются автоматически</span>
    </footer>
</div>

<script src="{{ url_for('static', path='dev/dev.js') }}" defer></script>
</body>
</html>